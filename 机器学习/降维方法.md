# 降维方法

### 奇异值分解

一些术语：

**正交矩阵：** 如果一个矩阵和它的转置矩阵的乘积为单位矩阵，则这个矩阵为正交矩阵。一个正交矩阵对应的变换叫做正交变换，正交变换的特点是不改变向量的长度和向量之间的夹角。

**酉矩阵：** 也叫幺正矩阵，即该矩阵的共轭转置矩阵等于逆矩阵。正交矩阵即为酉矩阵的实数特例。

**定义：** 假设 $A$ 是一个 $m\times n$ 阶的矩阵，如果存在一个分解使得
$$
A = U \Sigma V^\dagger
$$
其中 $U$ 是 $m\times m$ 阶的酉矩阵， $V^\dagger$ （即 $V$ 的共轭转置）是 $n\times n$ 阶的酉矩阵，$\Sigma$ 是半正定 $m\times n$ 阶的对角矩阵，这样的分解称为矩阵 $A$ 的奇异值分解，对角矩阵 $\Sigma$ 对角线上的元素即为奇异值。矩阵 $U$ 和 $V$ 的每个列向量分别称为左奇异向量和右奇异向量。

奇异值分解是**特征分解**的扩展，只有可对角化的方阵才能做特征分解。如果要比较的话，可以让矩阵 $A$ 左乘或右乘它的转置矩阵，然后对得到的方阵做特征分解。

将奇异值由大到小排列，很多情况下 $\Sigma_i$ 减少得特别快，我们就可以用前 $r$ 个奇异值来近似描述矩阵，这就是**部分奇异值分解**：
$$
A_{m\times n}\approx U_{m\times r} \Sigma_{r\times r} V^\dagger_{r\times n}
$$




### 主成分分析（PCA）

主成分分析本质上是找到一个基的变换，使得在某些方向上数据变化很小，从而实现降维。

例如有一些房屋的样本，我们采集到每个房屋的价格和面积：

|        | a    | b    | c    | d    | e    |
| ------ | ---- | ---- | ---- | ---- | ---- |
| 房价 X | 10   | 2    | 1    | 7    | 3    |
| 面积 Y | 9    | 3    | 2    | 6.5  | 2.5  |

这里有5个样本，描述这些样本需要房价和面积两个维度，可以画在一张二维图上。

但实际上房价和面积是有相关性的，只要旋转坐标系就可以把数据点投影到一条直线上，而且数据点在垂直方向的变化很小。

旋转后的坐标系，横纵坐标代表房价和面积的混合，被称为 $PC1$ 和 $PC2$ ， $PC2$ 很小，因此只需要 $PC1$ 就可以描述数据。



**PCA的步骤**

第一步：中心化。对 X 和 Y 分别求平均值，然后对每个样例都减去平均值。即把数据点的中心移动到原点，便于计算。

第二步：求协方差矩阵：
$$
C=\left(\begin{matrix}
cov(x,x) & cov(x,y) \\
cov(y,x) & cov(y,y) 
\end{matrix}\right)
$$
对角线上是方差，非对角线上是协方差。协方差表示两个变量发生变化时的关联程度，协方差越大，两者之间的影响越大。

第三步：求协方差矩阵的特征值和特征向量。

第四步：将特征值按从大到小排列，根据需求选择最大的前 $k$ 个，将其对应的 $k$ 个特征向量作为列向量组成特征向量矩阵。

第五步：将样本点投影到选取的特征向量上。



**理解**

在信号处理中，我们认为信号具有较大的方差，噪声具有较小的方差。因此我们希望把维度转化为 $k$ 维后，每一维上样本的方差都很大。

使用**最小二乘法来**确定各个主元的方向。

给定一组中心化后的数据 $\{x_1,x_2,...,x_n\}$ ，每个数据表示一个向量。设第一个主元（$PC1$）为 $u_1$ ，我们希望数据在 $u_1$ 方向上的投影的绝对值的和最大（等价于方差最大），即最大化下式：
$$
\begin{align}
Q &= \frac1n\sum^n_{i=1}(x^T_i\cdot u_1)^2 \\
  &= \frac1n\sum^n_{i=1}(x^T_i\cdot u_1)^T(x^T_i\cdot u_1) \\
  &= \frac1n\sum^n_{i=1} u_1^T x_i x^T_i u_1 \\
  &= \frac1n u_1^T \sum^n_{i=1} (x_i x^T_i) u_1 \\
  &= \frac1n u_1^T XX^T u_1 \\
\end{align}
$$
其中 $u_1^T XX^T u_1$ 是一个二次型。对矩阵 $XX^T$ 做特征分解，最大的特征值对应的特征向量就是主元 1 的方向，第二大的特征值对应的特征向量就是主元 2 的方向，以此类推。





**参考：**

[1] 如何通俗易懂地讲解什么是 PCA 主成分分析？ - 知乎
https://www.zhihu.com/question/41120789?sort=created

[2] 主成分分析（PCA）原理详解_李春春的专栏-CSDN博客_pca
https://blog.csdn.net/zhongkelee/article/details/44064401