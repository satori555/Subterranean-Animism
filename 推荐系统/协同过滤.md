# 协同过滤

协同过滤（collaborative Filtering recommendation）算法是最经典、最常用的推荐算法。该算法通过分析用户的兴趣，在用户群中找到指定用户的相似用户，综合这些相似用户对某一信息的评价，形成系统对该指定用户针对此信息的喜好程度的预测。

实现协同过滤，需要以下几个步骤：

1. 收集用户偏好
2. 找到相似的用户或物品
3. 计算并推荐

## 用户评分

用户评分可以采用多种方式，取决于所讨论的系统。

如：“ 0 到 5 星“ ”已购买” “查看了该书的人还查看了” 等。

收集数据后还需要进行预处理，如减噪和归一化等。

最后得到一个用户评分表：

| 用户/物品 | 物品A | 物品B | 物品C |
| --------- | ----- | ----- | ----- |
| 用户A     | 0.1   | 0.8   | 1     |
| 用户B     | ？    | 0.1   | 0.1   |
| 用户C     | 0.5   | 0.3   | ？    |



## 相似度计算

在对用户的行为进行分析得到用户的偏好后，可以根据用户的偏好计算相似用户或相似物品，然后可以基于相似用户或相似物品进行推荐。

##### 同现相似度

物品 A 和物品 B 的同现相似度：
$$
w_{A,B} = \frac{|N(A)\cap N(B)|}{|N(A)|}
$$
其中分母 $N(A)$ 是喜欢物品 A 的用户数，分子是同时喜欢 A 和 B 的用户数。上述公式可以理解为，喜欢物品 A 的用户中，有多少比例也喜欢 B。

假如 B 是热门物品，很多人都喜欢，那么 $w_{A,B}$ 就会很大，接近于 1。为了避免推荐热门物品，可以采用这个公式：
$$
w_{A,B}=\frac{|N(A)\cap N(B)|}{\sqrt{|N(A)||N(B)|}}
$$
这个公式 “惩罚” 了物品 B 的权重，因此减小了热门物品与很多物品相似的可能性。

此外还可以计算欧氏距离，皮尔逊相关系数，余弦相似度等，这三种距离在数据标准化 $\mu=0,\sigma=1$ 后等价。

## 基于用户的协同过滤（UserCF）

基于用户对物品的偏好找到相邻用户，然后将相邻用户喜欢的物品推荐给当前用户。

计算时，将一个 用户对所有物品的喜好作为一个向量，来计算用户之间的相似度。

## 基于物品的协同过滤（ItemCF）

基于用户对物品的喜好找到相似物品，然后根据用户的历史偏好推荐相似的物品给他。

计算时，将所有用户对某个物品的偏好作为向量，计算物品之间的相似度。

## 基于内容相似的召回

内容相似就是通过对物品内容的理解，得到物品的向量表达，然后计算得到相似物品列表。

基于文本内容的物品，常用 word2vec 方法计算相似内容。